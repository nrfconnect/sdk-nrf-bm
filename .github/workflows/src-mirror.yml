name: src-mirror

on:
  push:
    tags:
      - '*'
  pull_request:
    types:
      - opened
      - synchronize
    paths:
      - .github/workflows/src-mirror.yml

jobs:
  zip-and-upload:
    runs-on: ubuntu-24.04-16cores

    steps:
      - name: Upload source to Artifactory
        uses: nrfconnect/action-src-mirror@main
        with:
          git-ref: ${{ github.ref }}
          git-fetch-depth: '0'
          path: 'ncs-bm'
          west-update-args: ''
          artifactory-url: 'https://eu.files.nordicsemi.com/artifactory'
          artifactory-repository: 'ncs-src-mirror'
          artifactory-target-prefix: 'external/sdk-nrf-bm'
          artifactory-target-file-name: 'src.tar.gz'
          artifactory-user: ${{ secrets.COM_NORDICSEMI_FILES_USERNAME }}
          artifactory-pass: ${{ secrets.COM_NORDICSEMI_FILES_PASSWORD }}
