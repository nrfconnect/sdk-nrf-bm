s115_9.0.0-2.prototype
======================

This version is a major release, providing support for nRF54L series devices.

Notes:

- This release has changed the API. This requires changes to applications.
- The release notes list changes since s115_9.0.0-1.prototype.


SoftDevice properties
---------------------

* This SoftDevice variant is compatible with
  nRF54L05, nRF54L10, and nRF54L15.

* The SoftDevice memory requirements for this version are as follows:

  * NVM: **128.0 kB** (0x20000 bytes).

  * RAM: **4.9 kB** (0x1380 bytes).
    This is the minimum required memory. The actual requirements depend on the
    configuration chosen at ``sd_ble_enable()`` time.

  * Call stack: The SoftDevice uses a call stack combined with the application.
    The worst-case stack usage for the SoftDevice is
    **1.8 kB**
    (0x700 bytes). Application writers should ensure
    that enough stack space is reserved to cover the worst-case SoftDevice call
    stack usage combined with the worst-case application call stack usage.

* SoftDevice base address:

  * nRF54L05: 0x05D000 (``s115_9.0.0-2.prototype+offset-0x05D000_softdevice.hex``).

  * nRF54L10: 0x0DF800 (``s115_9.0.0-2.prototype+offset-0x0DF800_softdevice.hex``).

  * nRF54L15: 0x15D000 (``s115_9.0.0-2.prototype+offset-0x15D000_softdevice.hex``).

* The Firmware ID of this SoftDevice is 0x3106.

Changes
-------

  * Application needs to do relevant ISR forwarding to SoftDevice. See ``nrf_sd_isr.h``. (DRGN-25185)

  * Connection handles generated by the SoftDevice are no longer restricted to the range
    [0..<max_connections-1>], and must not be used as array indices.

  * The functions  ``sd_nvic_EnableIRQ``, ``sd_nvic_DisableIRQ``, ``sd_nvic_GetPendingIRQ``, ``sd_nvic_SetPendingIRQ``,
    ``sd_nvic_ClearPendingIRQ``, ``sd_nvic_SetPriority``, ``sd_nvic_GetPriority``, ``sd_nvic_SystemReset``,
    ``sd_nvic_critical_region_enter``, ``sd_nvic_critical_region_exit`` have been removed. An application must use the
    CMSIS ``NVIC_*`` functions instead. Make sure that the application does not use the interrupts and interrupt priorities
    owned by the SoftDevice.

  * Setting of RAM retention for the first memory blocks has been removed.

Limitations
-----------

* SoftDevice

  * If Radio Notifications are enabled, flash write and flash erase operations
    initiated through the SoftDevice API will be notified to the application as
    Radio Events (DRGN-5197).

  * Synthesized low frequency clock source is not tested or intended for use
    with the Bluetooth LE stack.

  * Applications must not modify the SEVONPEND flag in the SCR register when
    running in priority levels higher than 6 (priority level numerical values
    lower than 6) as this can lead to undefined behavior.

  * The SoftDevice may generate several events when connected, based on peer
    actions, meaning without previous action from the application. The
    ``BLE_GAP_EVT_PHY_UPDATE_REQUEST`` event, for instance, is generated when a
    connected peer sends a Phy Update Request, even when an application does not
    include logic to change PHY. There are several such events that may require
    action from an application if they are received. For more information, see the
    ``sd_ble_enable()`` API in SoftDevice.

  * Configuring multiple connection configurations (see ``ble_conn_cfg_t::conn_cfg_tag``) is not supported (DRGN-23839).

* GATT

  * To conform to the Bluetooth Core Specification, there shall be no
    secondary service that is not referenced somehow by a primary service. The
    SoftDevice does not enforce this (DRGN-906).

Known Issues
------------

* SoftDevice

  * The Radio Notification signal is not yet supported. The function ``sd_radio_notification_cfg_set``
    must not be used (DRGN-24324).

* GAP

  * Privacy feature is not yet supported. (DRGN-23358)

  * If the Peer Preferred Connection Parameters Characteristic (PPCP) contains "No
    specific values indication (0xFFFF)", application should not perform a peripheral
    initiated connection parameter update using PPCP. Otherwise invalid values will be
    used in ``L2CAP_CONNECTION_PARAMETER_UPDATE_REQ``. A workaround is to always specify
    the connection parameters in the ``sd_ble_gap_conn_param_update`` call (DRGN-15111).

  * The ``BLE_GAP_EVT_SEC_INFO_REQUEST`` event will not report the identity
    address of the peer to the application. A workaround is to do a mapping of the
    connection handle to the peer's identity address (DRGN-10340).

* GATTS

  * Queued Writes are not yet supported. Receiving the ``ATT_PREPARE_WRITE_REQ`` PDU
    will lead to assert (DRGN-23848).

* GATTC

  * The ``ble_gattc_service_t::uuid`` field is incorrectly populated in the
    ``BLE_GATTC_EVT_PRIM_SRVC_DISC_RSP`` event if
    ``sd_ble_gattc_primary_services_discover()`` or ``sd_ble_gattc_read()`` is
    called when a Primary Service Discovery by Service UUID is already ongoing.
    When the application has called
    ``sd_ble_gattc_primary_services_discover()``, it should wait for the
    ``BLE_GATTC_EVT_PRIM_SRVC_DISC_RSP`` event before calling
    ``sd_ble_gattc_primary_services_discover()`` or ``sd_ble_gattc_read()``
    (DRGN-11300).

* LL

  * If the application adds an all zeroes IRK with the
    ``sd_ble_gap_device_identities_set()``, it will be treated as a valid entry
    in the device identity list. An all zeroes IRK is invalid and must not be
    added (DRGN-9083).
